title = "Statistic"
url = "/statistic/:slug"
layout = "main"
is_hidden = 0
child_of = "mey_no_parent"
hide_crumb = 0
remove_crumb_trail = 0
crumb_disabled = 0

[session]
security = "user"
redirect = "main"

[StorePage]
page = "{{ :slug }}"

[StoreStatistics]
page = "{{ :slug }}"
==
<?php
function onStart() {
	$this['storeSlug'] = $this->param('slug');
}
?>
==
{% set obStore = StorePage.get() %}
<div class="wrapper">
	<section>
		<div class="container">
			<div class="row">
				<div class="col-md-3">

					{% partial 'cabinet/side-nav'  page='customer'%}

				</div>
				<div class="col-md-9">
					<div class="statistic">
						<ul class="statistic-items">
							<li class="statistic-item">
								<input type="checkbox" id="statisticMonth"/>
								<label for="statisticMonth">
									<div class="statistic-headline">
										<h5>Статистика за месяц</h5>
									</div>
								</label>
								<div class="statistic-content">
									<ul class="statistic-circles">
										<li class="statistic-circle col-md-4 col-12">
											<input type="text" value="{{monthAgoSalesCount}}" class="checksMonth" data-readOnly="true"  data-linecap="round" data-thickness="0.05" data-fgColor="#ffa001">
											<b>Чеков</b>
										</li>
										<li class="statistic-circle col-md-4 col-12">
											<input type="text" value="{{monthAgoStoreOrders}}" class="sellMonth" data-readOnly="true" data-linecap="round" data-thickness="0.05" data-fgColor="#4ec77d">
											<b>Продаж</b>
										</li>
										<li class="statistic-circle col-md-4 col-12">
											<input type="text" value="{{allMonthViews}}" class="viewsMonth" data-readOnly="true" data-linecap="round" data-thickness="0.05" data-fgColor="#66c2d1">
											<b>Кол-во просмотров страниц</b>
										</li>
									</ul>
									<div class="statistic-check">
										<div class="statistic-check-selling">
											{% set monthPriceWithoutDiscount = monthAgoStoreOrders + monthAgoStoreOrdersDiscount%}

											<em>Продажа</em>
											<p><strong>{{monthPriceWithoutDiscount}}</strong> <span> Сум</span></p>
										</div>
										<div class="statistic-check-revenue">
											<em>Скидка</em>
											<p><strong>{{monthAgoStoreOrdersDiscount}}</strong> <span> Сум</span></p>
										</div>
										<div class="statistic-check-commission">
											<em>Комиссия</em>
											<p><strong>{{storeCommission}}</strong><span> %</span></p>
										</div>
										<div class="statistic-check-total">
											<em>Итого</em>
											<p><strong>{{monthAgoStoreOrders}}</strong><span> Сум</span></p>
										</div>
									</div>
								</div>
							</li>
							<li class="statistic-item">
								<input type="checkbox" id="statisticHalfYear"/>
								<label for="statisticHalfYear">
									<div class="statistic-headline">
										<h5>Статистика за полугодие</h5>
									</div>
								</label>
								<div class="statistic-content">
									<ul class="statistic-circles">
										<li class="statistic-circle col-md-4 col-12">
											<input type="text" value="{{halfYearSalesCount}}" class="checksHalfYear" data-readOnly="true"  data-linecap="round" data-thickness="0.05" data-fgColor="#ffa001">
											<b>Чеков</b>
										</li>
										<li class="statistic-circle col-md-4 col-12">
											<input type="text" value="{{halfYearStoreOrders}}" class="sellHalfYear" data-readOnly="true" data-linecap="round" data-thickness="0.05" data-fgColor="#4ec77d">
											<b>Продаж</b>
										</li>
										<li class="statistic-circle col-md-4 col-12">
											<input type="text" value="{{allHalfYearViews}}" class="viewsHalfYear" data-readOnly="true" data-linecap="round" data-thickness="0.05" data-fgColor="#66c2d1">
											<b>Кол-во просмотров страниц</b>
										</li>
									</ul>
									<div class="statistic-check">
										{%set halfYearStoreOrdersWithoutDiscount = halfYearStoreOrders + halfYearStoreOrdersDiscount  %}
										<div class="statistic-check-selling">
											<em>Продажа</em>
											<p><strong>{{halfYearStoreOrdersWithoutDiscount}}</strong> <span> Сум</span></p>
										</div>
										<div class="statistic-check-revenue">
											<em>Скидка</em>
											<p><strong>{{halfYearStoreOrdersDiscount}}</strong> <span> Сум</span></p>
										</div>
										<div class="statistic-check-commission">
											<em>Комиссия</em>
											<p><strong>{{storeCommission}}</strong><span> %</span></p>
										</div>
										<div class="statistic-check-total">
											<em>Итого</em>
											<p><strong>{{halfYearStoreOrders}}</strong><span> Сум</span></p>
										</div>
									</div>
								</div>
							</li>
							<li class="statistic-item">
								<input type="checkbox" id="statisticYear"/>
								<label for="statisticYear">
									<div class="statistic-headline">
										<h5>Статистика за год</h5>
									</div>
								</label>
								<div class="statistic-content flex-column justify-content-center">

									<div class="statistic-content-top d-flex ">
										<ul class="statistic-circles">
											<li class="statistic-circle col-md-4 col-12">
												<input type="text" value="{{yearSalesCount}}" class="checksYear" data-readOnly="true"  data-linecap="round" data-thickness="0.05" data-fgColor="#ffa001">
												<b>Чеков</b>
											</li>
											<li class="statistic-circle col-md-4 col-12">
												<input type="text" value="{{yearStoreOrders}}" class="sellYear" data-readOnly="true" data-linecap="round" data-thickness="0.05" data-fgColor="#4ec77d">
												<b>Продаж</b>
											</li>
											<li class="statistic-circle col-md-4 col-12">
												<input type="text" value="{{allYearViews}}" class="viewsYear" data-readOnly="true" data-linecap="round" data-thickness="0.05" data-fgColor="#66c2d1">
												<b>Кол-во просмотров страниц</b>
											</li>
										</ul>
										<div class="statistic-check">
											{% set yearStoreOrdersWithoutDiscount = yearStoreOrders + yearStoreOrdersDiscount  %}
											<div class="statistic-check-selling">
												<em>Продажа</em>
												<p><strong>{{yearStoreOrdersWithoutDiscount}}</strong> <span> Сум</span></p>
											</div>
											<div class="statistic-check-revenue">
												<em>Скидка</em>
												<p><strong>{{yearStoreOrdersDiscount}}</strong> <span> Сум</span></p>
											</div>
											<div class="statistic-check-commission">
												<em>Комиссия</em>
												<p><strong>{{storeCommission}}</strong><span>%</span></p>
											</div>
											<div class="statistic-check-total">
												<em>Итого</em>
												<p><strong>{{yearStoreOrders}}</strong><span> Сум</span></p>
											</div>
										</div>
									</div>
									<div class="statistic-content-bottom d-flex flex-row justify-content-center align-items-center w-100">
										<div id="xAxisTickMultiline"></div>
										<script>
											var orders = new Array();
											{% for order in orders %}
											  orders.push({
											    value : '{{order.allvalue}}',
											    month: '{{order.months}}'
											  });
											{% endfor %}
											console.log(orders);
                                          var chart = bb.generate({
                                            data: {
                                              x: "x",
                                              columns: [
                                                ["x", ...orders.map(e=>e.month)],
                                                ["Продажы", ...orders.map(e=>e.value)]
                                              ]
                                            },
                                            axis: {
                                              x: {
                                                type: "category"
                                              }
                                            },
                                            bindto: "#xAxisTickMultiline"
                                          });
										</script>
									</div>
								</div>
							</li>

						</ul>
					</div>
				</div>
			</div>
		</div>
	</section>
</div>
{%put scripts%}
<script src="{{ 'assets/js/jquery.knob.min.js' | theme }}"></script>
{%endput%}

